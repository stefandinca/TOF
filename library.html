<!doctype html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" type="image/png" href="img/tof_icon.png">
  <link href="./styles.css" rel="stylesheet">
  <link href="./library.css" rel="stylesheet">
  <title>Game Library - Twist of Fate Cafe</title>
</head>
<body>
  <!-- Header -->
  <header class="flex justify-center py-6">
    <a href="index.html">
      <img src="img/TOF_Logo_small.png" alt="Twist of Fate" class="w-64"/>
    </a>
  </header>

  <!-- Page Title -->
  <div class="text-center py-6">
    <h1 class="text-3xl font-bold">Board Game Library</h1>
    <p class="text-xl font-medium py-3">Explore our collection of 300+ board games</p>
  </div>

  <!-- Search Bar (Always Visible) -->
  <div class="search-container">
    <input
      type="text"
      id="searchInput"
      placeholder="Search games by name, publisher, theme..."
      class="search-input"
    />
    <!-- What to Play Button -->
    <button id="whatToPlayBtn" class="what-to-play-btn">
      <span class="iconify" data-icon="ant-design:bulb-filled"></span>
      <span>What to Play?</span>
    </button>
    <!-- Mobile Filter Toggle Button -->
    <button id="filterToggleBtn" class="filter-toggle-btn">
      <span class="iconify" data-icon="ant-design:filter-outlined"></span>
      <span>Filters</span>
    </button>
  </div>

  <!-- Mobile Filter Overlay -->
  <div id="filterOverlay" class="filter-overlay hidden">
    <div class="filter-overlay-content">
      <div class="filter-overlay-header">
        <h3>Filters</h3>
        <button id="closeFilterOverlay" class="filter-overlay-close">
          <span class="iconify" data-icon="ant-design:close-outlined"></span>
        </button>
      </div>

      <div class="filter-overlay-body">
        <!-- Player Count -->
        <div class="filter-group">
          <div class="filter-group-title">Player Count</div>
          <div class="player-count-range">
            <div class="range-input-group">
              <label for="playerMinMobile">Min</label>
              <input type="number" id="playerMinMobile" class="range-input" min="1" max="20" placeholder="1">
            </div>
            <span class="range-separator">-</span>
            <div class="range-input-group">
              <label for="playerMaxMobile">Max</label>
              <input type="number" id="playerMaxMobile" class="range-input" min="1" max="20" placeholder="Any">
            </div>
          </div>
        </div>

        <!-- Game Mode -->
        <div class="filter-group">
          <div class="filter-group-title">Game Mode</div>
          <select id="modeFilterMobile" class="filter-select-mobile">
            <option value="">All Game Modes</option>
            <option value="Competitive">Competitive</option>
            <option value="Cooperative">Cooperative</option>
            <option value="Solo">Solo</option>
            <option value="Team-Based">Team-Based</option>
            <option value="Conversation">Conversation</option>
          </select>
        </div>

        <!-- Inventory Category -->
        <div class="filter-group">
          <div class="filter-group-title">Inventory</div>
          <select id="categoryFilterMobile" class="filter-select-mobile">
            <option value="">All Types</option>
            <option value="Base Game">Base Game</option>
            <option value="Expansion">Expansion</option>
          </select>
        </div>

        <!-- Complexity -->
        <div class="filter-group">
          <div class="filter-group-title">Complexity</div>
          <select id="complexityFilterMobile" class="filter-select-mobile">
            <option value="">All Complexities</option>
            <option value="light">Light (1-2)</option>
            <option value="medium-light">Medium Light (2-3)</option>
            <option value="medium">Medium (3-4)</option>
            <option value="heavy">Heavy (4+)</option>
          </select>
        </div>

        <!-- Categories (Checkboxes) -->
        <div class="filter-group">
          <div class="filter-group-title">Categories</div>
          <input type="text" class="checkbox-search" id="categoriesSearchMobile" placeholder="Search categories...">
          <div id="categoriesCheckboxesMobile" class="checkbox-group collapsible" data-type="categories-mobile">
            <!-- Dynamically populated -->
          </div>
          <button class="show-more-btn hidden" data-target="categories-mobile">Show more</button>
        </div>

        <!-- Mechanics (Checkboxes) -->
        <div class="filter-group">
          <div class="filter-group-title">Mechanics</div>
          <input type="text" class="checkbox-search" id="mechanicsSearchMobile" placeholder="Search mechanics...">
          <div id="mechanicsCheckboxesMobile" class="checkbox-group collapsible" data-type="mechanics-mobile">
            <!-- Dynamically populated -->
          </div>
          <button class="show-more-btn hidden" data-target="mechanics-mobile">Show more</button>
        </div>

        <!-- Sort -->
        <div class="filter-group">
          <div class="filter-group-title">Sort By</div>
          <select id="sortSelectMobile" class="filter-select-mobile">
            <option value="title">Name</option>
            <option value="rating">Rating</option>
            <option value="playTimeMin">Play Time</option>
            <option value="playerCountMin">Players</option>
          </select>
        </div>
      </div>

      <div class="filter-overlay-footer">
        <button id="applyFiltersMobile" class="filter-btn-apply">Apply Filters</button>
        <button id="resetFiltersMobile" class="filter-btn-reset">Reset</button>
      </div>
    </div>
  </div>

  <!-- Main Layout: Sidebar + Content -->
  <div class="library-layout">
    <!-- Desktop Sidebar Filters -->
    <aside class="filters-sidebar desktop-filters">
      <div class="sidebar-content">
        <!-- Sort -->
        <div class="filter-group">
          <div class="filter-group-title">Sort By</div>
          <select id="sortSelect" class="filter-select-sidebar">
            <option value="title">Name</option>
            <option value="rating">Rating</option>
            <option value="playTimeMin">Play Time</option>
            <option value="playerCountMin">Players</option>
          </select>
        </div>

        <!-- Player Count -->
        <div class="filter-group">
          <div class="filter-group-title">Player Count</div>
          <div class="player-count-range">
            <div class="range-input-group">
              <label for="playerMin">Min</label>
              <input type="number" id="playerMin" class="range-input" min="1" max="20" placeholder="1">
            </div>
            <span class="range-separator">-</span>
            <div class="range-input-group">
              <label for="playerMax">Max</label>
              <input type="number" id="playerMax" class="range-input" min="1" max="20" placeholder="Any">
            </div>
          </div>
        </div>

        <!-- Game Mode -->
        <div class="filter-group">
          <div class="filter-group-title">Game Mode</div>
          <select id="modeFilter" class="filter-select-sidebar">
            <option value="">All Game Modes</option>
            <option value="Competitive">Competitive</option>
            <option value="Cooperative">Cooperative</option>
            <option value="Solo">Solo</option>
            <option value="Team-Based">Team-Based</option>
            <option value="Conversation">Conversation</option>
          </select>
        </div>

        <!-- Inventory Category -->
        <div class="filter-group">
          <div class="filter-group-title">Inventory</div>
          <select id="categoryFilter" class="filter-select-sidebar">
            <option value="">All Types</option>
            <option value="Base Game">Base Game</option>
            <option value="Expansion">Expansion</option>
          </select>
        </div>

        <!-- Complexity -->
        <div class="filter-group">
          <div class="filter-group-title">Complexity</div>
          <select id="complexityFilter" class="filter-select-sidebar">
            <option value="">All Complexities</option>
            <option value="light">Light (1-2)</option>
            <option value="medium-light">Medium Light (2-3)</option>
            <option value="medium">Medium (3-4)</option>
            <option value="heavy">Heavy (4+)</option>
          </select>
        </div>

        <!-- Categories (Checkboxes) -->
        <div class="filter-group">
          <div class="filter-group-title">Categories</div>
          <input type="text" class="checkbox-search" id="categoriesSearch" placeholder="Search categories...">
          <div id="categoriesCheckboxes" class="checkbox-group collapsible" data-type="categories">
            <!-- Dynamically populated -->
          </div>
          <button class="show-more-btn hidden" data-target="categories">Show more</button>
        </div>

        <!-- Mechanics (Checkboxes) -->
        <div class="filter-group">
          <div class="filter-group-title">Mechanics</div>
          <input type="text" class="checkbox-search" id="mechanicsSearch" placeholder="Search mechanics...">
          <div id="mechanicsCheckboxes" class="checkbox-group collapsible" data-type="mechanics">
            <!-- Dynamically populated -->
          </div>
          <button class="show-more-btn hidden" data-target="mechanics">Show more</button>
        </div>

        <!-- Reset Button -->
        <button id="resetFilters" class="filter-btn-sidebar">Reset All Filters</button>
      </div>
    </aside>

    <!-- Game List View -->
    <main class="library-content">
      <div id="gameListView">
        <!-- Loading State -->
        <div id="loading" class="flex justify-center py-12">
          <div class="loading-spinner"></div>
        </div>

        <!-- Results Count -->
        <div id="resultsCount" class="text-center text-sm py-3 hidden"></div>

        <!-- Game of the Month Banner -->
        <div id="gotmBanner" class="gotm-banner hidden">
          <div class="gotm-banner-content">
            <div class="gotm-banner-image">
              <img id="gotmBannerImage" src="" alt="Game of the Month" />
            </div>
            <div class="gotm-banner-info">
              <div class="gotm-banner-label">
                <span class="iconify" data-icon="ant-design:trophy-filled"></span>
                Game of the Month
              </div>
              <h3 id="gotmBannerTitle" class="gotm-banner-title"></h3>
              <p id="gotmBannerDate" class="gotm-banner-date"></p>
            </div>
            <div class="gotm-banner-action">
              <span class="gotm-banner-cta">View All Past Winners</span>
              <span class="iconify" data-icon="ant-design:right-outlined"></span>
            </div>
          </div>
        </div>

        <!-- Games Grid -->
        <div id="gamesGrid" class="games-grid"></div>

        <!-- No Results Message -->
        <div id="noResults" class="text-center py-12 hidden">
          <p class="text-xl font-semibold">No games found</p>
          <p class="text-sm py-3">Try adjusting your filters or search terms</p>
        </div>
      </div>

      <!-- Game Detail View -->
      <div id="gameDetailView" class="game-detail-view hidden">
        <div class="detail-header">
          <button id="backButton" class="back-button">
            <span class="iconify" data-icon="ant-design:arrow-left-outlined"></span>
            Back to Library
          </button>
        </div>
        <div id="gameDetailContent" class="detail-content"></div>
      </div>

      <!-- Past Games View -->
      <div id="pastGamesView" class="past-gotm-view hidden">
        <div class="detail-header">
          <button id="backToLibFromPast" class="back-button">
            <span class="iconify" data-icon="ant-design:arrow-left-outlined"></span>
            Back to Library
          </button>
        </div>
        <div class="past-gotm-view-header">
          <h2 class="past-gotm-view-title">
            <span class="iconify" data-icon="ant-design:trophy-filled"></span>
            Past Games of the Month
          </h2>
          <p class="past-gotm-view-subtitle">A collection of our previously featured favorites</p>
        </div>
        <div id="pastGamesGrid" class="games-grid"></div>
      </div>
    </main>
  </div>



  <!-- What to Play Survey Modal -->
  <div id="surveyModal" class="survey-modal hidden">
    <div class="survey-modal-content">
      <button id="closeSurveyModal" class="survey-modal-close">
        <span class="iconify" data-icon="ant-design:close-outlined"></span>
      </button>

      <!-- Survey Header -->
      <div class="survey-header">
        <span class="iconify survey-header-icon" data-icon="ant-design:bulb-filled"></span>
        <h2>What Should You Play?</h2>
        <p>Answer a few questions and we'll find the perfect game for your group!</p>
      </div>

      <!-- Progress Bar -->
      <div class="survey-progress">
        <div class="survey-progress-bar" id="surveyProgressBar"></div>
      </div>
      <div class="survey-progress-text" id="surveyProgressText">Question 1 of 6</div>

      <!-- Survey Questions Container -->
      <div id="surveyQuestions" class="survey-questions">
        <!-- Questions will be dynamically inserted here -->
      </div>

      <!-- Survey Result Container -->
      <div id="surveyResult" class="survey-result hidden">
        <div class="survey-result-header">
          <span class="iconify" data-icon="ant-design:check-circle-filled"></span>
          <h3>We Found Your Game!</h3>
        </div>
        <div id="surveyResultCard" class="survey-result-card">
          <!-- Game card will be inserted here -->
        </div>
        <div class="survey-result-actions">
          <button id="viewGameBtn" class="survey-btn-primary">
            <span class="iconify" data-icon="ant-design:eye-outlined"></span>
            View Game Details
          </button>
          <div class="survey-result-secondary-actions">
            <button id="showAnotherBtn" class="survey-btn-secondary">
              <span class="iconify" data-icon="ant-design:swap-outlined"></span>
              Show Another
            </button>
            <button id="restartSurveyBtn" class="survey-btn-secondary">
              <span class="iconify" data-icon="ant-design:reload-outlined"></span>
              Try Again
            </button>
          </div>
        </div>
      </div>

      <!-- No Match Result -->
      <div id="surveyNoMatch" class="survey-no-match hidden">
        <span class="iconify" data-icon="ant-design:frown-outlined"></span>
        <h3>No Perfect Match Found</h3>
        <p>We couldn't find a game that matches all your criteria. Try adjusting your preferences!</p>
        <button id="restartSurveyBtnNoMatch" class="survey-btn-secondary">
          <span class="iconify" data-icon="ant-design:reload-outlined"></span>
          Try Again
        </button>
      </div>

      <!-- Navigation Buttons -->
      <div id="surveyNavigation" class="survey-navigation">
        <button id="surveyPrevBtn" class="survey-nav-btn" disabled>
          <span class="iconify" data-icon="ant-design:arrow-left-outlined"></span>
          Back
        </button>
        <button id="surveyNextBtn" class="survey-nav-btn survey-nav-btn-primary">
          Next
          <span class="iconify" data-icon="ant-design:arrow-right-outlined"></span>
        </button>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <div class="flex justify-center w-full border-t-2 border-t-(--accent) py-12"></div>

  <div class="flex justify-center py-6">
    <img src="img/TOF_Logo_small.png" alt="Twist of Fate"/>
  </div>

  <div class="flex-col justify-center items-center text-center py-3">
    <p class="text-sm">Â© 2025 Twist of Fate. All rights reserved.</p>
    <p class="text-sm">Magic by <a target="_blank" href="http://www.stefandinca.ro">stefandinca.ro</a></p>
  </div>

  <!-- Iconify for Ant Design Icons -->
  <script src="https://code.iconify.design/3/3.1.0/iconify.min.js"></script>

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

  <!-- Library Script -->
  <script type="module" src="library.js"></script>
</body>
</html>
